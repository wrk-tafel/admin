<form cForm [formGroup]="userSearchForm">
  <c-card>
    <c-card-body>
      <c-row>
        <c-col class="mb-3">
          <h4>Benutzer-Suche</h4>
        </c-col>
      </c-row>
      <c-row>
        <c-col sm="3">
          <label class="form-label">Personalnummer</label>
        </c-col>
      </c-row>
      <c-row>
        <c-col sm="3" class="mb-3">
          <input testid="personnelNumberText" type="text" formControlName="personnelNumber" name="personnelNumber"
                 class="form-control" autofocus (keydown.enter)="searchForPersonnelNumber()">
        </c-col>
        <c-col sm="3">
          <button testid="showuser-button" type="button" class="btn btn-primary text-white"
                  [disabled]="!personnelNumber.value" (click)="searchForPersonnelNumber()">Anzeigen</button>
        </c-col>
      </c-row>
      <hr>
      <c-row>
        <c-col sm="3">
          <label class="form-label">Familienname</label>
          <input testid="lastnameText" type="text" formControlName="lastname" name="lastname"
                 class="form-control">
        </c-col>
        <c-col sm="3">
          <label class="form-label">Vorname</label>
          <input testid="firstnameText" type="text" formControlName="firstname" name="firstname"
                 class="form-control">
        </c-col>
      </c-row>
      <c-row>
        <c-col sm="3" class="mt-3">
          <button testid="search-button" type="button" class="btn btn-primary text-white"
                  [disabled]="!firstname.value && !lastname.value" (click)="searchForDetails()">Suchen</button>
        </c-col>
      </c-row>
      <c-row *ngIf="searchResult" testid="searchresult-table">
        <c-col>
          <hr>
        </c-col>
      </c-row>
      <c-row *ngIf="searchResult">
        <c-card>
          <c-card-header>
            <i class="fa fa-align-justify"></i> Suchergebnis
          </c-card-header>
          <c-card-body>
            <c-row>
              <c-col sm="12">
                <!-- TODO fix mobile layout -->
                <table cTable striped="true" aria-label="Liste der gefundenen Benutzer">
                  <thead>
                    <tr>
                      <th scope="col"></th>
                      <th scope="col">Nr.</th>
                      <th scope="col">Nachname</th>
                      <th scope="col">Vorname</th>
                      <th scope="col">Geb. Datum</th>
                      <th scope="col">Aktionen</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr testid="searchresult-row" scope="row"
                        *ngFor="let user of searchResult.items; let i = index">
                      <td><i class="fa fa-user"></i></td>
                      <td [attr.testid]="'searchresult-id-' + i">{{user.id}}</td>
                      <td [attr.testid]="'searchresult-lastname-' + i">{{user.lastname}}</td>
                      <td [attr.testid]="'searchresult-firstname-' + i">{{user.firstname}}</td>
                      <td [attr.testid]="'searchresult-birthDate-' + i">{{user.birthDate | date : 'dd.MM.yyyy'}}</td>
                      <td>
                        <div class="row">
                          <div class="col-3">
                            <button [attr.testid]="'searchresult-showuser-button-' + i"
                                    type="button" class="btn btn-primary text-white"
                                    (click)="navigateToUser(user.id)"><i
                              class="fa fa-search"></i></button>
                          </div>
                          <div class="col-3 ms-2">
                            <button [attr.testid]="'searchresult-edituser-button-' + i"
                                    type="button" class="btn btn-danger text-white"
                                    (click)="editUser(user.id)"><i
                              class="fa fa-pencil"></i></button>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </c-col>
            </c-row>
          </c-card-body>
        </c-card>
      </c-row>
    </c-card-body>
  </c-card>
</form>
